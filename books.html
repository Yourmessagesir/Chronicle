<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Crimson+Pro:ital,wght@0,300;0,400;0,600;1,300;1,400&display=swap" rel="stylesheet">
<style>
:root{--bg:#0d0d0f;--bg2:#13131a;--bg3:#1a1a24;--bg4:#222230;--border:#2e2e42;--border2:#3d3d58;--gold:#c9a84c;--gold2:#e8c97a;--text:#d4d4e8;--text2:#9090aa;--text3:#5a5870;--red:#cc5555;--green:#55aa77;--amber:#cc8844;--accent:#7b6cee;--accent2:#a99bff;}
*{box-sizing:border-box;margin:0;padding:0;}
body{background:var(--bg);color:var(--text);font-family:'Crimson Pro',Georgia,serif;font-size:16px;min-height:100vh;overflow-x:hidden;}
body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.03'/%3E%3C/svg%3E");pointer-events:none;z-index:9999;opacity:0.4;}
.btn{padding:7px 12px;border:1px solid var(--border2);background:var(--bg3);color:var(--text);border-radius:3px;font-family:'Cinzel',serif;font-size:10px;letter-spacing:.06em;cursor:pointer;transition:all .15s;white-space:nowrap;}
.btn:active{border-color:var(--gold);color:var(--gold);}
.btn-gold{background:linear-gradient(135deg,#8a6a20,var(--gold));border-color:var(--gold2);color:#1a1200;font-weight:600;}
.btn-danger{border-color:var(--red);color:var(--red);}
.field{margin-bottom:12px;}
label{display:block;font-family:'Cinzel',serif;font-size:10px;letter-spacing:.08em;color:var(--text2);text-transform:uppercase;margin-bottom:4px;}
input[type="text"],textarea,select{background:var(--bg3);border:1px solid var(--border);color:var(--text);padding:8px 12px;border-radius:3px;font-family:'Crimson Pro',serif;font-size:15px;width:100%;outline:none;transition:border-color .2s;}
input:focus,textarea:focus{border-color:var(--gold);}
select option{background:var(--bg3);}
textarea{resize:vertical;min-height:80px;line-height:1.7;}
.empty-state{text-align:center;padding:20px;color:var(--text3);font-style:italic;font-size:13px;}

/* Book selector tabs */
.book-tabs{display:flex;gap:4px;padding:10px 14px;overflow-x:auto;flex-shrink:0;}
.book-tabs::-webkit-scrollbar{display:none;}
.book-tab{padding:5px 12px;border:1px solid var(--border);border-radius:14px;font-family:'Cinzel',serif;font-size:9px;letter-spacing:.06em;cursor:pointer;white-space:nowrap;color:var(--text2);background:transparent;transition:all .15s;}
.book-tab.active{border-color:var(--gold);color:var(--gold);background:rgba(201,168,76,.08);}

/* Main view */
#bookMain{padding:0 14px 40px;}
.book-meta{background:var(--bg2);border:1px solid var(--border);border-radius:6px;padding:14px;margin-bottom:12px;display:flex;gap:14px;align-items:flex-start;}
.book-cover{width:60px;height:85px;border-radius:3px;object-fit:cover;border:1px solid var(--border2);}
.book-info{flex:1;}
.book-title{font-family:'Cinzel',serif;font-size:16px;color:var(--gold);letter-spacing:.08em;}
.book-sub{font-size:12px;color:var(--text2);font-style:italic;margin:2px 0 8px;}
.book-stats{font-family:'Cinzel',serif;font-size:10px;color:var(--text2);}
.actions-row{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:12px;}

/* Chapters */
.chapter-item{display:flex;justify-content:space-between;align-items:center;padding:12px 14px;background:var(--bg2);border:1px solid var(--border);border-radius:4px;margin-bottom:6px;cursor:pointer;transition:border-color .15s;}
.chapter-item:active{border-color:var(--gold);}
.chapter-num{font-family:'Cinzel',serif;font-size:9px;color:var(--text3);letter-spacing:.08em;margin-bottom:2px;}
.chapter-title-text{font-family:'Cinzel',serif;font-size:12px;color:var(--text);}

/* Editor overlay */
#editorView{position:fixed;inset:0;background:var(--bg);z-index:200;display:none;flex-direction:column;}
#editorView.open{display:flex;}
.ed-bar{display:flex;align-items:center;gap:8px;padding:10px 14px;background:var(--bg2);border-bottom:1px solid var(--border);flex-shrink:0;}
.ed-bar .field{margin:0;flex:1;}
.ed-body{flex:1;display:flex;flex-direction:column;padding:14px;}
.ed-body textarea{flex:1;min-height:0;}
.ed-footer{display:flex;gap:8px;padding:10px 14px;background:var(--bg2);border-top:1px solid var(--border);flex-shrink:0;}
.word-count{font-family:'Cinzel',serif;font-size:9px;color:var(--text3);text-align:right;margin-top:4px;}

/* Timeline panel */
.panel{background:var(--bg2);border:1px solid var(--border);border-radius:6px;padding:14px;margin-bottom:12px;display:none;}
.panel.open{display:block;}
.pp-line{position:absolute;left:18px;top:15px;bottom:15px;width:2px;background:var(--border);}
.pp-node{display:flex;gap:10px;margin-bottom:10px;position:relative;}
.pp-icon{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;font-size:14px;z-index:1;}
.pp-card{flex:1;background:var(--bg3);border:1px solid var(--border);border-radius:5px;padding:8px 10px;}

/* Full view */
#fullViewArea{display:none;padding:0 14px 40px;}
#fullViewArea .ch-heading{font-family:'Cinzel',serif;font-size:14px;color:var(--gold);letter-spacing:.08em;margin:20px 0 10px;padding-bottom:6px;border-bottom:1px solid var(--border);}
#fullViewContent{font-size:16px;line-height:1.8;white-space:pre-wrap;}

/* Cheat sheet */
.cheat-item{font-size:12px;color:var(--text);line-height:1.65;padding:3px 0 3px 12px;border-left:2px solid var(--border2);margin-bottom:2px;}

/* Modals */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,.75);z-index:300;display:none;align-items:flex-end;justify-content:center;}
.modal-overlay.open{display:flex;}
.modal{background:var(--bg2);border:1px solid var(--border2);border-radius:8px 8px 0 0;width:100%;max-width:600px;max-height:92vh;overflow-y:auto;padding:20px;padding-bottom:calc(20px + env(safe-area-inset-bottom,0));}
.modal h2{font-family:'Cinzel',serif;font-size:16px;color:var(--gold);letter-spacing:.1em;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid var(--border);}
.modal-actions{display:flex;gap:8px;margin-top:16px;justify-content:flex-end;}
::-webkit-scrollbar{width:4px;}::-webkit-scrollbar-track{background:var(--bg);}::-webkit-scrollbar-thumb{background:var(--border2);border-radius:2px;}
</style>
</head>
<body>

<div class="book-tabs" id="bookTabs"></div>
<div id="bookMain">
  <div class="book-meta" id="bookMeta"></div>
  <div class="actions-row">
    <button class="btn" onclick="openBookSettings()">‚öô Book Settings</button>
    <button class="btn" id="timelineBtn" onclick="toggleTimeline()">üìà Timeline</button>
    <button class="btn" id="cheatBtn" onclick="toggleCheat()">üìù Writing Tips</button>
    <button class="btn" id="fullViewBtn" onclick="toggleFullView()">üìñ Full View</button>
  </div>
  <div class="panel" id="timelinePanel"></div>
  <div class="panel" id="cheatPanel"></div>
  <button class="btn btn-gold" style="width:100%;margin-bottom:12px;" onclick="openAddChapter()">+ Add Chapter</button>
  <div id="chapterList"></div>
</div>
<div id="fullViewArea"><div id="fullViewContent"></div></div>

<!-- Chapter Editor -->
<div id="editorView">
  <div class="ed-bar">
    <div class="field"><input type="text" id="chTitle" placeholder="Chapter title‚Ä¶"></div>
    <button class="btn" onclick="saveChapter()">Save</button>
    <button class="btn" onclick="closeEditor()">‚úï</button>
  </div>
  <div class="ed-body">
    <textarea id="chContent" placeholder="Write your chapter‚Ä¶" oninput="updateWc()"></textarea>
    <div class="word-count" id="wc">0 words</div>
  </div>
  <div class="ed-footer">
    <button class="btn btn-danger" id="delChBtn" onclick="deleteChapter()" style="display:none;">Delete Chapter</button>
    <div style="flex:1;"></div>
    <button class="btn btn-gold" onclick="saveChapter()">Save</button>
  </div>
</div>

<!-- Book Settings Modal -->
<div class="modal-overlay" id="modal-book">
  <div class="modal">
    <h2 id="bookModalTitle">Edit Book</h2>
    <div class="field"><label>Title</label><input type="text" id="bTitle" placeholder="Book title"></div>
    <div class="field"><label>Author</label><input type="text" id="bAuthor" placeholder="Author name"></div>
    <div class="field"><label>Genre</label><input type="text" id="bGenre" placeholder="Fantasy, Sci-Fi‚Ä¶"></div>
    <div class="field"><label>Cover Image URL</label><input type="text" id="bCover" placeholder="https://‚Ä¶"></div>
    <div class="modal-actions">
      <button class="btn btn-danger" id="delBookBtn" onclick="deleteBook()" style="display:none;">Delete Book</button>
      <button class="btn" onclick="closeModal('modal-book')">Cancel</button>
      <button class="btn btn-gold" onclick="saveBookSettings()">Save</button>
    </div>
  </div>
</div>

<!-- Add Plot Point Modal -->
<div class="modal-overlay" id="modal-pp">
  <div class="modal">
    <h2>Add Plot Point</h2>
    <div class="field"><label>Title</label><input type="text" id="ppTitle" placeholder="e.g. The Inciting Incident‚Ä¶"></div>
    <div style="display:flex;gap:8px;">
      <div class="field" style="flex:1;"><label>Type</label>
        <select id="ppType"><option>Setup</option><option>Rising</option><option>Climax</option><option>Falling</option><option>Resolution</option><option>Subplot</option><option>Twist</option><option>Note</option></select>
      </div>
      <div class="field" style="flex:1;"><label>Chapter / Act</label><input type="text" id="ppChapter" placeholder="e.g. Ch. 3"></div>
    </div>
    <div class="field"><label>Notes</label><textarea id="ppNotes" rows="2" placeholder="Brief description‚Ä¶"></textarea></div>
    <div class="modal-actions">
      <button class="btn" onclick="closeModal('modal-pp')">Cancel</button>
      <button class="btn btn-gold" onclick="savePlotPoint()">Add to Timeline</button>
    </div>
  </div>
</div>

<script>
'use strict';
let editingChapterId=null, fullViewOpen=false, timelineOpen=false, cheatOpen=false;
const TC={Setup:'#5588cc',Rising:'#cc8844',Climax:'#cc4444',Falling:'#9944cc',Resolution:'#44aa66',Subplot:'#5577aa',Twist:'#cc44aa',Note:'#778899'};
const TI={Setup:'üåÖ',Rising:'üìà',Climax:'‚ö°',Falling:'üìâ',Resolution:'üèÅ',Subplot:'üîÄ',Twist:'üåÄ',Note:'üìå'};

function getData(){try{const s=localStorage.getItem('chronicle_data');return s?JSON.parse(s):{books:[]};}catch(e){return{books:[]};}}
function saveData(d){localStorage.setItem('chronicle_data',JSON.stringify(d));}
function uid(){return Date.now().toString(36)+Math.random().toString(36).slice(2);}
function esc(s){return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
function toast(m,c){if(window.parent!==window)window.parent.postMessage({type:'toast',msg:m,cls:c},'*');}

function getActive(){
  const d=getData();
  if(!d.books||!d.books.length){const b={id:uid(),title:'My Book',author:'',genre:'',coverUrl:'',chapters:[]};d.books=[b];d.activeBookId=b.id;saveData(d);}
  return{data:d,book:d.books.find(b=>b.id===d.activeBookId)||d.books[0]};
}

// ‚ïê‚ïê‚ïê RENDER ‚ïê‚ïê‚ïê
function renderAll(){renderTabs();renderMeta();renderChapters();if(timelineOpen)renderTimeline();if(fullViewOpen)renderFullView();}

function renderTabs(){
  const d=getData();
  document.getElementById('bookTabs').innerHTML=(d.books||[]).map(b=>
    `<button class="book-tab${b.id===d.activeBookId?' active':''}" onclick="switchBook('${b.id}')">${esc(b.title)}</button>`
  ).join('')+`<button class="book-tab" onclick="openAddBook()">+ Book</button>`;
}

function renderMeta(){
  const{book:b}=getActive();
  const words=(b.chapters||[]).reduce((a,c)=>a+(c.content||'').trim().split(/\s+/).filter(Boolean).length,0);
  const sub=[b.author?'by '+b.author:'',b.genre].filter(Boolean).join(' ¬∑ ');
  document.getElementById('bookMeta').innerHTML=`
    ${b.coverUrl?`<img class="book-cover" src="${esc(b.coverUrl)}" onerror="this.style.display='none'">`:''}
    <div class="book-info">
      <div class="book-title">${esc(b.title)}</div>
      ${sub?`<div class="book-sub">${esc(sub)}</div>`:''}
      <div class="book-stats">${(b.chapters||[]).length} chapter${(b.chapters||[]).length!==1?'s':''} ¬∑ ~${words.toLocaleString()} words</div>
    </div>`;
}

function renderChapters(){
  const{book:b}=getActive();
  const el=document.getElementById('chapterList');
  if(!(b.chapters||[]).length){el.innerHTML='<div class="empty-state">No chapters yet. Start writing!</div>';return;}
  el.innerHTML=b.chapters.map((c,i)=>{
    const w=(c.content||'').trim().split(/\s+/).filter(Boolean).length;
    return`<div class="chapter-item" onclick="openEditor('${c.id}')">
      <div><div class="chapter-num">CHAPTER ${i+1}</div><div class="chapter-title-text">${esc(c.title||'Untitled')}</div></div>
      <div style="text-align:right;"><div style="font-size:11px;color:var(--text2);">${w} words</div></div>
    </div>`;}).join('');
}

function switchBook(id){const d=getData();d.activeBookId=id;saveData(d);fullViewOpen=false;document.getElementById('fullViewArea').style.display='none';document.getElementById('bookMain').style.display='block';renderAll();}

// ‚ïê‚ïê‚ïê BOOK SETTINGS ‚ïê‚ïê‚ïê
function openAddBook(){
  document.getElementById('bookModalTitle').textContent='New Book';
  document.getElementById('delBookBtn').style.display='none';
  ['bTitle','bAuthor','bGenre','bCover'].forEach(id=>document.getElementById(id).value='');
  openModal('modal-book');
}
function openBookSettings(){
  const{book:b}=getActive();
  document.getElementById('bookModalTitle').textContent='Edit Book';
  document.getElementById('delBookBtn').style.display='inline-block';
  document.getElementById('bTitle').value=b.title||'';
  document.getElementById('bAuthor').value=b.author||'';
  document.getElementById('bGenre').value=b.genre||'';
  document.getElementById('bCover').value='';
  openModal('modal-book');
}
function saveBookSettings(){
  const title=document.getElementById('bTitle').value.trim()||'My Book';
  const d=getData();const isNew=document.getElementById('bookModalTitle').textContent==='New Book';
  if(isNew){const b={id:uid(),title,author:document.getElementById('bAuthor').value.trim(),genre:document.getElementById('bGenre').value.trim(),coverUrl:document.getElementById('bCover').value.trim(),chapters:[]};d.books.push(b);d.activeBookId=b.id;}
  else{const b=d.books.find(x=>x.id===d.activeBookId);if(b){b.title=title;b.author=document.getElementById('bAuthor').value.trim();b.genre=document.getElementById('bGenre').value.trim();const cu=document.getElementById('bCover').value.trim();if(cu)b.coverUrl=cu;}}
  saveData(d);closeModal('modal-book');renderAll();toast('Book saved ‚ú¶');
}
function deleteBook(){
  const d=getData();if(d.books.length<=1){alert('You need at least one book.');return;}
  if(!confirm('Delete this book and all its chapters?'))return;
  d.books=d.books.filter(b=>b.id!==d.activeBookId);d.activeBookId=d.books[0].id;
  saveData(d);closeModal('modal-book');renderAll();
}

// ‚ïê‚ïê‚ïê CHAPTER EDITOR ‚ïê‚ïê‚ïê
function openAddChapter(){editingChapterId=null;document.getElementById('chTitle').value='';document.getElementById('chContent').value='';document.getElementById('delChBtn').style.display='none';document.getElementById('wc').textContent='0 words';document.getElementById('editorView').classList.add('open');}
function openEditor(id){
  const{book:b}=getActive();const c=(b.chapters||[]).find(x=>x.id===id);if(!c)return;
  editingChapterId=id;document.getElementById('chTitle').value=c.title||'';document.getElementById('chContent').value=c.content||'';
  document.getElementById('delChBtn').style.display='block';updateWc();document.getElementById('editorView').classList.add('open');
}
function closeEditor(){document.getElementById('editorView').classList.remove('open');editingChapterId=null;renderAll();}
function saveChapter(){
  const d=getData();const b=d.books.find(x=>x.id===d.activeBookId);if(!b)return;if(!b.chapters)b.chapters=[];
  const title=document.getElementById('chTitle').value.trim();const content=document.getElementById('chContent').value;
  if(editingChapterId){const c=b.chapters.find(x=>x.id===editingChapterId);if(c){c.title=title;c.content=content;c.updated=Date.now();}}
  else b.chapters.push({id:uid(),title,content,created:Date.now(),updated:Date.now()});
  saveData(d);closeEditor();toast('Chapter saved ‚ú¶');
}
function deleteChapter(){if(!confirm('Delete this chapter?'))return;const d=getData();const b=d.books.find(x=>x.id===d.activeBookId);if(!b)return;b.chapters=(b.chapters||[]).filter(x=>x.id!==editingChapterId);saveData(d);closeEditor();}
function updateWc(){const v=document.getElementById('chContent').value;const w=v.trim()?v.trim().split(/\s+/).length:0;document.getElementById('wc').textContent=w+' words';}

// ‚ïê‚ïê‚ïê TIMELINE ‚ïê‚ïê‚ïê
function toggleTimeline(){timelineOpen=!timelineOpen;document.getElementById('timelinePanel').classList.toggle('open',timelineOpen);document.getElementById('timelineBtn').style.color=timelineOpen?'var(--gold)':'';if(timelineOpen)renderTimeline();}
function renderTimeline(){
  const{book:b}=getActive();const pts=b.plotPoints||[];
  const el=document.getElementById('timelinePanel');
  let html='<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;"><span style="font-family:Cinzel,serif;font-size:10px;color:var(--gold);letter-spacing:.1em;">PLOT TIMELINE</span><button class="btn btn-gold" style="font-size:9px;padding:4px 8px;" onclick="openModal(\'modal-pp\')">+ Point</button></div>';
  if(!pts.length){html+='<div class="empty-state">No plot points yet.</div>';el.innerHTML=html;return;}
  html+='<div style="position:relative;padding-left:4px;"><div class="pp-line"></div>';
  pts.forEach((pt,i)=>{
    const col=TC[pt.type||'Note']||'#778899';const icon=TI[pt.type||'Note']||'üìå';
    html+=`<div class="pp-node"><div class="pp-icon" style="background:${col}22;border:2px solid ${col};">${icon}</div><div class="pp-card"><div style="display:flex;justify-content:space-between;"><div><div style="font-family:Cinzel,serif;font-size:11px;color:var(--gold);">${esc(pt.title)}</div><div style="font-size:9px;color:${col};margin-top:1px;">${esc(pt.type||'Note')}${pt.chapter?' ¬∑ '+esc(pt.chapter):''}</div></div><button onclick="deletePlotPoint(${i})" style="background:none;border:none;color:var(--text3);cursor:pointer;font-size:14px;">‚úï</button></div>${pt.notes?`<div style="font-size:12px;color:var(--text2);margin-top:5px;font-style:italic;">${esc(pt.notes)}</div>`:''}</div></div>`;
  });
  html+='</div>';el.innerHTML=html;
}
function savePlotPoint(){
  const title=document.getElementById('ppTitle').value.trim();if(!title)return;
  const d=getData();const b=d.books.find(x=>x.id===d.activeBookId);if(!b)return;if(!b.plotPoints)b.plotPoints=[];
  b.plotPoints.push({title,type:document.getElementById('ppType').value,chapter:document.getElementById('ppChapter').value.trim(),notes:document.getElementById('ppNotes').value.trim(),created:Date.now()});
  saveData(d);closeModal('modal-pp');renderTimeline();toast('Plot point added ‚ú¶');
}
function deletePlotPoint(i){if(!confirm('Remove this plot point?'))return;const d=getData();const b=d.books.find(x=>x.id===d.activeBookId);if(!b)return;b.plotPoints.splice(i,1);saveData(d);renderTimeline();}

// ‚ïê‚ïê‚ïê FULL VIEW ‚ïê‚ïê‚ïê
function toggleFullView(){
  fullViewOpen=!fullViewOpen;
  document.getElementById('bookMain').style.display=fullViewOpen?'none':'block';
  document.getElementById('fullViewArea').style.display=fullViewOpen?'block':'none';
  document.getElementById('fullViewBtn').textContent=fullViewOpen?'‚Üê Chapters':'üìñ Full View';
  if(fullViewOpen)renderFullView();
}
function renderFullView(){
  const{book:b}=getActive();
  document.getElementById('fullViewContent').innerHTML=(b.chapters||[]).map((c,i)=>
    `<div class="ch-heading">Chapter ${i+1}: ${esc(c.title||'Untitled')}</div>${esc(c.content||'')}`
  ).join('\n\n');
}

// ‚ïê‚ïê‚ïê CHEAT SHEET ‚ïê‚ïê‚ïê
function toggleCheat(){cheatOpen=!cheatOpen;document.getElementById('cheatPanel').classList.toggle('open',cheatOpen);document.getElementById('cheatBtn').style.color=cheatOpen?'var(--gold)':'';if(cheatOpen)renderCheat();}
function renderCheat(){
  const tips=[
    {icon:'üìè',title:'Chapter Length',items:['<strong>Sweet spot: ~3,000 words</strong> ‚Äî long enough to develop, short enough for pace.','<strong>Fast genres</strong> (thriller, YA): 1,500‚Äì2,500 words.','Under 1,000 words ‚Äî use sparingly for shock cuts.','Never pad to hit a count. End when the scene is done.']},
    {icon:'üèó',title:'Scene Structure',items:['Every scene: <strong>Goal ‚Üí Conflict ‚Üí Outcome</strong>.','End on a hook, reversal, or open question.','Alternate high-tension and recovery scenes.','If nothing changes in the scene, cut it.']},
    {icon:'üí¨',title:'Dialogue',items:['Use fragments, interruptions, silence.','Each character needs a distinct voice.','<strong>Subtext rules</strong>: characters rarely say what they mean.','Read every line aloud.']},
    {icon:'‚è±',title:'Pacing',items:['Short sentences accelerate. Long ones decelerate.','White space signals pace.','Place flashbacks deliberately.']},
    {icon:'üé≠',title:'Show vs Tell',items:['Show emotions through <strong>physical sensation and action</strong>.','\"Her hands shook\" beats \"She was nervous.\"','Telling is fine for transitions and minor characters.']},
    {icon:'üñä',title:'First Drafts',items:['<strong>Write fast, edit slow.</strong>','500 words/day = a novel in a year.','Leave a note at your stopping point.']},
    {icon:'‚úÇ',title:'Editing Order',items:['<strong>1. Structure</strong> ‚Äî does each chapter do its job?','<strong>2. Scene</strong> ‚Äî Goal ‚Üí Conflict ‚Üí Outcome?','<strong>3. Line</strong> ‚Äî cut words not earning their place.','<strong>4. Dialogue</strong> ‚Äî read aloud.','<strong>5. Proofread</strong> ‚Äî always last.']},
  ];
  document.getElementById('cheatPanel').innerHTML='<div style="font-family:Cinzel,serif;font-size:10px;color:var(--gold);letter-spacing:.1em;margin-bottom:10px;">WRITING TIPS</div>'+tips.map((s,i)=>`${i?'<div style="border-top:1px solid var(--border);margin:10px 0;"></div>':''}<div><div style="font-family:Cinzel,serif;font-size:11px;color:var(--gold);letter-spacing:.08em;margin-bottom:7px;">${s.icon} ${s.title}</div>${s.items.map(item=>`<div class="cheat-item">${item}</div>`).join('')}</div>`).join('');
}

// ‚ïê‚ïê‚ïê MODAL ‚ïê‚ïê‚ïê
function openModal(id){document.getElementById(id).classList.add('open');document.body.style.overflow='hidden';}
function closeModal(id){document.getElementById(id).classList.remove('open');document.body.style.overflow='';}
document.querySelectorAll('.modal-overlay').forEach(o=>o.addEventListener('click',e=>{if(e.target===o)closeModal(o.id);}));

renderAll();
document.addEventListener('visibilitychange',()=>{if(!document.hidden)renderAll();});
</script>
</body>
</html>
